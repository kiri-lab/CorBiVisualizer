/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package corbivisualizer;

import java.io.*;
import java.nio.charset.Charset;

import javafx.application.Application;
import javafx.scene.*;
import javafx.stage.Stage;
import javafx.scene.shape.*;
import javafx.application.Platform;
import corbivisualizer.communication.*;

public class App extends Application
{

    private static Rectangle rect = new Rectangle();

    @Override
    public void start(Stage stage)
    {
        Group root = new Group();
        // TODO この辺のプロパティ、どっかでまとめて定義しておいてくだちい
        Scene scene = new Scene(root, 800, 600);
        rect.setX(10);
        rect.setY(10);
        rect.setWidth(100);
        rect.setHeight(10);
        root.getChildren().add(rect);
        CorBiCoreReader corbiReader = new CorBiCoreReader(height -> updateHeight(height)).setDummy();
        new Thread(corbiReader::read).start();
        stage.setOnCloseRequest(event ->
        {
            corbiReader.destroy();
            System.exit(0);
        });
        stage.setScene(scene);
        stage.show();
    }

    public static void main(String[] args)
    {
        launch();
    }

    public static void updateHeight(double height)
    {
        // TODO rectを継承したクラスに実装しておいてくれい
        Platform.runLater(() ->
        {
            rect.setHeight(height);
        });
    }

}
